<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hybrid Post‑Quantum TLS 1.3 — Overview and Deployment (Early 2026)</title>
  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      max-width: 1000px;
      margin: 2rem auto;
      padding: 0 1rem;
      color: #1a1a1a;
    }
    h1, h2, h3 {
      line-height: 1.25;
    }
    h1 {
      border-bottom: 3px solid #ddd;
      padding-bottom: 0.5rem;
    }
    h2 {
      margin-top: 2.5rem;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 0.3rem;
    }
    pre {
      background: #f6f8fa;
      padding: 1rem;
      overflow-x: auto;
      border-radius: 6px;
    }
    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    table {
      border-collapse: collapse;
      margin: 1rem 0;
      width: 100%;
    }
    th, td {
      border: 1px solid #d0d0d0;
      padding: 0.5rem 0.75rem;
      text-align: left;
    }
    th {
      background: #f0f0f0;
    }
    blockquote {
      border-left: 4px solid #ccc;
      padding-left: 1rem;
      color: #555;
      margin: 1.5rem 0;
    }
    ul {
      margin-left: 1.5rem;
    }
    footer {
      margin-top: 4rem;
      font-size: 0.9rem;
      color: #555;
    }
  </style>
</head>
<body>

<h1>Hybrid Post‑Quantum TLS 1.3</h1>
<h2>Protocol Overview, Handshake Mechanics, and Real‑World Support (Early 2026)</h2>

<p>
This document consolidates all prior discussion into a single reference covering:
</p>

<ul>
  <li>What hybrid post‑quantum TLS is and why it exists</li>
  <li>How a hybrid TLS 1.3 handshake works step‑by‑step</li>
  <li>Which released clients and servers can negotiate <em>true</em> hybrid TLS</li>
  <li>Operational realities and deployment caveats</li>
</ul>

<h2>1. What “Hybrid Post‑Quantum TLS” Means</h2>

<p><strong>Hybrid TLS</strong> combines:</p>

<ul>
  <li><strong>Classical cryptography</strong>
    <ul>
      <li>ECDHE (e.g., X25519)</li>
      <li>Classical signatures (ECDSA / RSA)</li>
    </ul>
  </li>
  <li><strong>Post‑quantum cryptography</strong>
    <ul>
      <li>Key Encapsulation Mechanism (KEM): <strong>ML‑KEM‑768</strong> (formerly Kyber)</li>
    </ul>
  </li>
</ul>

<h3>Goal: Cryptographic Hedging</h3>

<p>
A connection remains secure unless <strong>both</strong> the classical algorithm
<strong>and</strong> the post‑quantum algorithm are broken.
</p>

<p>This protects against:</p>
<ul>
  <li>Harvest‑now, decrypt‑later attacks</li>
  <li>Unknown weaknesses in new PQ algorithms</li>
</ul>

<p>
Hybrid TLS is the <strong>transition strategy</strong> between classical TLS and future PQ‑only TLS.
</p>

<h2>2. Baseline: Normal TLS 1.3 Handshake (Refresher)</h2>

<pre><code>Client                     Server
------                     ------
ClientHello  -----------&gt;
  + key_share (ECDHE)

                        ServerHello
                        + key_share (ECDHE)
           &lt;-----------

[Handshake keys derived]

EncryptedExtensions
Certificate
CertificateVerify
Finished        &lt;-----------

Finished        -----------&gt;
</code></pre>

<ul>
  <li>Forward secrecy via ECDHE</li>
  <li>Authentication is separate from key exchange</li>
  <li>Handshake keys derived immediately after ServerHello</li>
</ul>

<h2>3. Where Hybrid PQ Fits into TLS 1.3</h2>

<p>
Hybrid TLS does <strong>not</strong> change TLS 1.3 structure.
</p>

<ul>
  <li>A new key‑exchange group is negotiated</li>
  <li>The TLS key schedule is fed multiple shared secrets</li>
</ul>

<p>
Authentication typically remains classical; key exchange becomes hybrid.
</p>

<h2>4. Hybrid TLS 1.3 Handshake (Step‑by‑Step)</h2>

<h3>Step 1: ClientHello — “I want hybrid”</h3>

<pre><code>ClientHello:
  supported_groups:
    - x25519_mlkem768
    - x25519
  key_share:
    - hybrid_keyshare (ECDHE_pub || PQ_pub)
    - classical_keyshare (ECDHE_pub)
</code></pre>

<p>
The classical key share exists as a fallback for compatibility.
</p>

<h3>Step 2: ServerHello — Hybrid selection</h3>

<pre><code>ServerHello:
  selected_group: x25519_mlkem768
  key_share:
    - ECDHE_public
    - PQ_KEM_ciphertext
</code></pre>

<h3>Step 3: Hybrid secret derivation</h3>

<pre><code>handshake_secret =
  HKDF-Extract(S_classical, S_pq)
</code></pre>

<p>
The TLS key schedule itself is unchanged.
</p>

<h3>Step 4: Encrypted handshake continues</h3>

<ul>
  <li>Certificate (classical)</li>
  <li>CertificateVerify (classical signature)</li>
  <li>Finished</li>
</ul>

<h2>5. Authentication vs Key Exchange</h2>

<table>
  <tr>
    <th>Function</th>
    <th>Algorithm</th>
  </tr>
  <tr>
    <td>Key exchange</td>
    <td>Hybrid (ECDHE + ML‑KEM)</td>
  </tr>
  <tr>
    <td>Authentication</td>
    <td>Classical (ECDSA / RSA)</td>
  </tr>
  <tr>
    <td>Record protection</td>
    <td>Symmetric (AES‑GCM / ChaCha20)</td>
  </tr>
</table>

<h2>6. Security Properties</h2>

<table>
  <tr>
    <th>Scenario</th>
    <th>Result</th>
  </tr>
  <tr>
    <td>Classical broken, PQ secure</td>
    <td>Secure</td>
  </tr>
  <tr>
    <td>PQ broken, classical secure</td>
    <td>Secure</td>
  </tr>
  <tr>
    <td>Both broken</td>
    <td>Broken</td>
  </tr>
</table>

<h2>7. Clients Supporting Hybrid TLS (Early 2026)</h2>

<table>
  <tr>
    <th>Client</th>
    <th>Status</th>
  </tr>
  <tr><td>Chrome 124+</td><td>✅</td></tr>
  <tr><td>Edge 124+</td><td>✅</td></tr>
  <tr><td>Firefox (late 2025+)</td><td>✅</td></tr>
  <tr><td>Safari (recent)</td><td>✅</td></tr>
</table>

<h2>8. Servers Supporting True Hybrid TLS</h2>

<table>
  <tr>
    <th>Server</th>
    <th>Status</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td>Cloudflare (edge)</td>
    <td>✅</td>
    <td>Hybrid ML‑KEM globally enabled</td>
  </tr>
  <tr>
    <td>NGINX / Apache / HAProxy</td>
    <td>✅</td>
    <td>Requires OpenSSL ≥ 3.5 or oqs‑provider</td>
  </tr>
</table>

<h2>9. Operational Reality</h2>

<ul>
  <li>Some middleboxes break on large ClientHello messages</li>
  <li>Some servers advertise TLS 1.3 but cannot parse hybrid groups</li>
</ul>

<p>
Browsers mitigate this by always including a classical fallback key share.
</p>

<h2>10. What Hybrid TLS Is Not</h2>

<ul>
  <li>Not two TLS handshakes</li>
  <li>Not a new TLS version</li>
  <li>Not a change to the record layer</li>
</ul>

<p>
Hybrid TLS <strong>is</strong> a new key‑exchange group fully compatible with TLS 1.3.
</p>

<blockquote>
Hybrid TLS is mainstream on the client side.  
Server crypto library lag remains the primary blocker.
</blockquote>

<footer>
  <p>Document version: Early 2026</p>
</footer>

</body>
</html>